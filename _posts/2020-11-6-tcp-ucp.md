---
title: TCP 和 UDP
description: 位于传输层的 TCP 和 UDP
tags:
- 网络
---

## UDP

1. 面向无连接<br>
2. 有单播、多播和广播的功能<br>
3. UDP 是面向报文的<br>
4. 不可靠<br>
5. 头部开销小，传输数据报文时是很高效的<br>

#### 面向连接

**不会对数据报文进行任何拆分和拼接操作**<br>
1. 发送端，应用层将数据传递到传输层到 UDP 协议，UDP 只会给数据增加一个 UDP 头标识下是 UDP 协议，然后就传送给网络层了.<br>
2. 接受端，网络层将数据传递给传输层，UDP 只去除 IP 报文头就传递给应用层，不会任何拼接操作.<br>

#### 有单播、多播和广播的功能

UDP 支持一对一、一对多、多对多、多对一的方式.

#### UDP 是面向报文的

发送方的 UDP 对应用程序交下来的报文，在添加首部后向下交付 IP 层. UDP 对应用层交下来的报文，即不合并，也不拆分，而是保留这些报文的边界. 因此，应用程序必须选择合适大小的报文.

#### 不可靠

1. 首先不可靠性体现在无连接上，通信都不需要建立连接，想发就发，这样的情况肯定不可靠.<br>
2. 并且收到什么数据就传递什么数据，并且并不会备份数据，发送数据也不会关心对方是否已经正确接收到数据了.<br>
3. 再者，网络环境时好时坏，但是 UDP 因为没有拥塞控制，一直会以恒定的速度发送数据. 即使网络条件不好，也不会对发送速率进行调整.<br>

#### 头部开销小，传输数据报文时是很高效的

**UDP 头部包含如下信息**<br>
1. 两个十六位的端口号，分别为源端口（可选字段）和目标端口.<br>
2. 整个数据报文的长度.<br>
3. 整个数据报文检验和（IPv4 可选字段），该字段用于发现头部信息和数据中的错误.<br>

**较为简短只有 8 字节**<br>

***

## TCP

1. 面向连接<br>
2. 仅支持单播传输<br>
3. 面向字节流<br>
4. 可靠传输<br>
5. 提供拥塞控制<br>
6. TCP 提供全双工通信<br>

#### 面向连接

**1. 第一次握手**<br>
客户端向服务器发送连接请求报文段. 该报文段中包含自身的数据通讯初始序号. 请求发送后，客户端便进入 SYN-SENT 状态.<br>

**2. 第二次握手**<br>
服务端收到连接请求报文段后，如果同意连接，则会发送一个应答，该应答中也会包含自身的数据通讯初始序号，发送完成后便进入 SYN-RECEIVED 状态.<br>

**3. 第三次握手**<br>
当客户端收到接收同意的应答后，还要向服务器发送一个确认报文. 客户端发完这个报文段后便进入 ESTABLISHED 状态，服务器收到这个应答后进入 ESTABLISHED 状态.<br>

#### 仅支持单播传输

仅支持点对点传输.

#### 面向字节流

TCP 不像 UDP 一样那样一个个报文独立地传输，而是在不保留报文边界的情况下以字节流方式进行传输.

#### 可靠传输

对于可靠传输，判断丢包，误码靠的是 TCP 的段编号以及确认号. TCP 为了保证报文传输的可靠，就给每个包一个序号，同时序号也保证了传送到接受端实体的包的按序接收. 然后接受端实体对已成功收到的字节发回一个相应的确认（ACK），如果发送端实体在合理的往返时延（RTT）内未收到确认，那么对应的数据（假设丢失了）将会被重传.

#### 提供拥塞控制

网络出现拥塞的时候，TCP 能够减少想网络注入数据的速率和数量，缓解拥塞.

#### TCP 提供全双工通信

TCP 允许通讯双方的应用程序在任何时候都能发送数据，因为 TCP 连接的两端都设有缓存，用来临时存放双向通讯的数据. 当然，TCP 可以立即发送一个数据段，也可以缓存一段时间以便一次发送更多的数据段（最大的数据段大小取决于 MSS）.

***
