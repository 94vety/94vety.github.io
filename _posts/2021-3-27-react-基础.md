---
title: react 基础
description: 对于 react 最基本的了解
tags:
- JavaScript
---

# 什么是 JSX

```bash
const element = <h1>Hello, world!</h1>
```

这种语法形式，既不是 **HTML**，也不是字符串，而是称之为 **JSX**，是 **React** 里用来描述 **UI** 和样式的语法，**JSX** 最终会被编译为合法的 **JS** 语句调用.<br>
（编译器在遇到 **{** 时采用 **JS** 语法进行解析，遇到 **<** 就采用 **HTML** 规则进行解析）<br>

***

# 嵌入表达式

**JSX** 中，可以使用花括号 **{}** 嵌入任意的 **JavaScript** 合法表达式，如 **2 + 2**、**user.firstName**、**formatName(user)** 都是合法的.<br>

```bash
const user = {
    firstName: 'Zhang',
    lastName: 'Busong'
}

const elem = {
    <h1>Hello, {firstName(user)}</h1>
}

ReactDOM.render(
    element,
    document.getElementById('app')
)
```

***

# JSX 也是一种表达式

**JSX** 本身也是一种表达式，所以它可以像其他表达式一样，用于给一个变量赋值、作为函数实参、作为函数返回值，等等<br>

```bash
function getGreeting(user) {
    if (user) {
        return <h1>Hello, {formatName(user)}</h1>
    }

    return <h1>Hello, Guest!</h1>
}
```

***

# JSX 实质

**JSX** 通过 **babel** 编译，而 **babel** 实际上把 **JSX** 编译给 **React.createElement()** 调用.<br>

```bash
const element = {
    <h1 className="greeting">
        Hello, world!
    </h1>
}
```

等同于<br>

```bash
const elem = React.createElement(
    'h1',
    { className: 'greeting' },
    'Hello, world!'
)
```

**React.createElement()** 方法会首先进行一些避免 BUG 的检车<br>

```bash
const element = {
    type: 'h1',
    props: {
        className: 'greeting',
        children: 'Hello, world'
    }
}
```

这样的对象，则称为 **React元素**，代表所有呈现在屏幕上的东西. **React** 正是通过读取这些对象来构建 **DOM**，并且保持数据和 **UI** 同步的.<br>

***

# 元素渲染

元素 **{ element }** 是构成 **React** 应用的最小单元，元素描述了想要在屏幕中看到的内容.<br>

```bash
const element = <h1>Hello, world</h1>
```

和 **DOM** 元素不同的是，**React** 元素是纯对象，创建的代价低. 并且 **React** 会进行优化处理，只把有必要的变化更新到 **DOM** 上. 此外，元素和组件的概念，是不一样的，组件是由元素组成的.<br>

***

# 将元素渲染进 DOM 

在 **React** 中，使用 **ReactDOM.render()** 方法将 **React** 元素渲染进一个 **DOM** 中.<br>

```bash
ReactDOM.render(
    element,
    document.getElementById('root')
)
```

**React** 元素是不可变的，所以一旦一个元素创建完成后，我们是无法改变其内容或者属性的. 一个元素就像是动画里的一帧，代表 **UI** 在某一时间带点的样子. 如果非要使用元素来构成可变化的 **UI** 界面，就需要使用 **setInterval** 了.<br>

```bash
function tick() {
    const element = (
        <div>Now is {new Date().toLocaleTimeString()}</div>
    );

    ReactDOM.render(
        element,
        document.getElementById('root')
    );
}

setInterval(tick, 1000)
```

在实际开发中，大多数 **React** 应用只会调用一次 **ReactDOM.render()**，所以更好的方式是使用 **有状态组件**.

***

# 组件和 Props

组件 **( component )** 能够将 **UI** 划分为独立的、可复用的部分，这样我们就只需专注于构建每一个单独的部件.<br>
从概念上看，组件就像是函数，接受的任意的输入（称为属性，**Props**），返回 **React** 元素.<br>
React 中有两种定义组件的方式：**函数定义** 和 **定义**.<br>

## 函数定义组件

这种方式是最简单的定义组件的方式，就像写一个 **JavaScript** 函数一样.<br>

```bash
function Welcome(props) {
    return <h1>Hello, {props.name}</h1>
} 
```

## 类定义组件

还可以使用 **ES6** 里的类来定义一个组件.<br>

```bash
class Welcome extends React.Component {
    render() {
        return <h1>Hello, {this.props.name}</h1>
    }
}
```

这种方式比起 **函数定义** 更加灵活

## 组件渲染

之前，我们遇到的 **React** 元素只是呈现一个 **DOM** 标签

```bash
const element = <div />
```

**React** 也可以是用户自定义的 **组件** 

```bash
const element = <Welcome name="Tom" />
```

**Welcome** 组件中声明了一个属性 **name="Tom"**，而这个属性，将以 **props.name** 的方式传递给组件

```bash
function Welcome(props) {
    return <h1>Hello, {props.name}</h1>
}
```

此时，对于以下代码

```bash
ReactDOM.render(
    <Welcome name='张伞' />,
    document.getElementById('root')
)
```

最终都会以 ```<h1>Hello, 张伞</h1>```，该过程中如下<br>
1. 对 元素调用了 丰富.<br>
2. **React** 将 ```{ name: '张伞' }``` 作为 **props** 实参来调用 Welcome 组件.<br>
3. **Welcome** 渲染完成，返回 ```<h1>Hello, 张伞</h1>``` 元素.<br>
4. **ReactDOM** 计算最小更新代价，然后更新 **DOM**.<br>

## 组合组件

组件是可以组合的，即组件内部可以引用其他组件

```bash
function Welcome(props) {
    return <h1>Hello, {props.name}</h1>
}

function App() {
    return (
        <div>
            <Welcome name="Tom">
            <Welcome name="Jack">
            <Welcome name="Mike">
        </div>
    )
}

ReactDOM.render(
    <App />,
    document.getElementById('root')
)
```

**注意：**在 React 组件必须返回 **单一** 的根元素，这也是为什么 App 组件中需要用 ```<div>``` 标签包裹的原因.

## 属性是可读的

考虑以下情况

```bash
function sum (a, b) {
    return a + b
}
```

这种函数称为 **纯函数**，纯函数不改变自己的输入值，且总是对相同的输入返回相同的结果.<br>
与之对立的，是 **非纯函数**.

```bash
function withdraw (account, amount) {
    account.total -= amount
}
```

**非纯函数** 在函数内改变了输入的参数. 在 React 中，无论是通过 function 还是 class 声明组件，我们都不应该修改它自身的属性（props）.<br>
虽然 React 相当灵活，但是它有一个严格的规定：<br>
```所有的 React 组件都必须像纯函数那样来使用它们的 props````
